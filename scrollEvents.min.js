!function(e){function t(e,t,i,s){if(e.isVisible&&e.b<=se.t||s&&e.b<=se.t)if(t&&(e.isVisible=!1),!s&&i)e.up(e);else if(s&&i)return e.up;return!1}function i(e,t,i,s){if(e.isVisible&&e.t>=se.b||s&&e.t>=se.b)if(t&&(e.isVisible=!1),!s&&i)e.down(e);else if(s&&i)return e.down;return!1}function s(e,t,i,s){if(!e.isVisible&&e.t<se.b&&e.b>se.t||s&&e.t<se.b&&e.b>se.t)if(t&&(e.isVisible=!0),!s&&i)e.visible(e);else if(s&&i)return e.visible;return!1}function o(e,t,i,s){if(e.isTopVisible&&e.t<=se.t||s&&e.t<=se.t)if(t&&(e.isTopVisible=!1),!s&&i)e.topUp(e);else if(s&&i)return e.topUp;return!1}function n(e,t,i,s){if(!e.isTopVisible&&e.t>se.t||s&&e.t>se.t)if(t&&(e.isTopVisible=!0),!s&&i)e.topDown(e);else if(s&&i)return e.topDown;return!1}function r(e,t,i,s){if(e.isBottomVisible&&e.b<se.b||s&&e.b<se.b)if(t&&(e.isBottomVisible=!1),!s&&i)e.bottomUp(e);else if(s&&i)return e.bottomUp;return!1}function l(e,t,i,s){if(!e.isBottomVisible&&e.b>=se.b||s&&e.b>=se.b)if(t&&(e.isBottomVisible=!0),!s&&i)e.bottomDown(e);else if(s&&i)return e.bottomDown;return!1}function a(e,t,i,s){(e.isVisible&&e.b<=se.t||s&&e.b<=se.t)&&(t&&!e.up&&(e.isVisible=!1),i&&window.raf.off(e.container,"scroll",e.travel)),(e.isVisible&&e.t>=se.b||s&&e.t>=se.b)&&(t&&!e.down&&(e.isVisible=!1),i&&window.raf.off(e.container,"scroll",e.travel)),(!e.isVisible&&e.t<se.b&&e.b>se.t||s&&e.t<se.b&&e.b>se.t)&&(t&&!e.visible&&(e.isVisible=!0),(i||s)&&window.raf.on(e.container,"scroll",{delta:function(){return minMax(Math.round((se.t-(e.t-se.wh))/(e.h+e.offset+e.offsetBottom+se.wh)*e.round)/e.round,0,1)},selection:e.selection,index:e.i,height:e.h},e.travel))}function f(e){e.checks=[],e.travel&&e.checks.push({event:e,fn:a,activate:!0,callback:!!e.travel}),(e.up||e.checkdown||e.visible)&&e.checks.push({event:e,fn:t,activate:!0,callback:!!e.up},{event:e,fn:i,activate:!0,callback:!!e.down},{event:e,fn:s,activate:!0,callback:!!e.visible}),(e.topUp||e.topDown)&&e.checks.push({event:e,fn:n,activate:!0,callback:!!e.topDown},{event:e,fn:o,activate:!0,callback:!!e.topUp}),(e.bottomUp||e.bottomDown)&&e.checks.push({event:e,fn:l,activate:!0,callback:!!e.bottomDown},{event:e,fn:r,activate:!0,callback:!!e.bottomUp})}function c(e){if("boolean"==typeof e)var t=!0,i=[];se.t=$win.scrollTop(),se.b=se.t+se.wh;for(var s=0;s<se.selection.length;s++)for(var o=se.selection[s],n=0;n<o.ev.length;n++)(function(e){if(!e.disabled)for(var s=0;s<e.checks.length;s++){var o=e.checks[s],n=o.fn(e,o.activate,o.callback,t);n&&i.push({callback:n,e:e})}})(o.ev[n]);if(t&&i.length){i.sort(sortCallbacksByDistance);for(var r=0;r<i.length;r++)"function"==typeof i[r].callback&&i[r].callback(i[r].e)}}function b(){se.wh=$win.height();for(var t=0;t<se.selection.length;t++){var i=e(se.selection[t]),s=i[0],o=i.outerHeight();s.style.position=s.initialStates.position,s.style.top=s.initialStates.top;for(var n=Math.round(i.offset().top),r=0;r<s.ev.length;r++){var l=s.ev[r];l.h=o,l.t=n-l.offset,l.b=l.t+l.h+l.offsetBottom}s.style.position="",s.style.top=""}}function v(){window.raf.on("nextframe",function(){b(),c(!0)})}function u(t,i,s,o){if("destroy"==i)window.raf.off("scroll",c),window.raf.on("afterdocumentresize",v),window.se.selection=[];else if("resize"==i)v();else if("trigger"==i)c("update");else if("update"==i)v("update");else if("disable"==i||"enable"==i||"remove"==i||"set"==i||"eval"==i){for(var t=e(t),n=[],r=0;r<t.length;r++){var l=t[r];if(l.ev)if("remove"==i)n.push(l);else for(var f=0;f<l.ev.length;f++){var b=l.ev[f];if("eval"==i){var u=o?o:s,h=o?s:!1;if(b[u]&&(!h||h&&h==b.flag))return"travel"==u?{data:{delta:function(){return Math.round((se.t-(b.t-se.wh))/(b.h+se.wh)*100)/100},selection:b.selection,index:b.i,height:b.h}}:b[u](b)}else s?b.flag==s&&("disable"==i?(b.disabled=!0,b.travel&&window.raf.off(b.container,"scroll",b.travel)):"enable"==i?(b.disabled=!1,b.travel&&(d.isVisible=!1,a(b,!0,!0))):"set"==i&&e.extend(!0,b,o)):"disable"==i?(b.disabled=!0,b.travel&&window.raf.off(b.container,"scroll",b.travel)):"enable"==i?(b.disabled=!1,b.travel&&(b.isVisible=!1,a(b,!0,!0))):"set"==i&&e.extend(!0,b,o)}}if("remove"==i){n.sort(function(e,t){return t.ev.se-e.ev.se});for(var p=0;p<n.length;p++){var d=n[p];d.ev&&!d.ev.travel&&window.raf.off(d.container,"scroll",d.ev.visibleFn),se.selection.splice(d.ev.se,1)}for(var r=0;r<se.selection.length;r++)se.selection[r].ev.se=r}}return t}$win=e(window),window.se={selection:[],t:$win.scrollTop(),b:$win.height(),wh:$win.height()},Function.prototype.clone=function(){var e=this,t=function(){return e.apply(this,arguments)};for(var i in this)this.hasOwnProperty(i)&&(t[i]=this[i]);return t},minMax=function(e,t,i){return t>e?t:e>i?i:e},sortByOrder=function(e,t){return e.order<t.order?-1:e.order>t.order?1:0},sortCallbacksByDistance=function(e,t){var i=Math.abs(e.e.topUp||e.e.topDown?se.t-e.e.t:se.b-e.e.b),s=Math.abs(t.e.topUp||t.e.topDown?se.t-t.e.t:se.b-t.e.b);return s>i?1:i>s?-1:0},e.extend(e.fn,{scrollEvents:function(t,i,s){return"string"==typeof t?u(this,t,i,s):(e(this).each(function(i){var s=e.extend(!0,{selection:e(this),container:$win,flag:!1,order:0,offset:0,offsetBottom:0,round:100,visible:!1,up:!1,down:!1,topUp:!1,topDown:!1,bottomUp:!1,bottomDown:!1,travel:!1,isVisible:!1,isTopVisible:!1,isBottomVisible:!1,h:e(this).outerHeight(),t:0,b:e(this).outerHeight(),i:i,disabled:!1,checks:[]},t);s.travel=t.travel?t.travel.clone():!1,f(s),s.checks.sort(sortByOrder);for(var o=!1,n=0;n<se.selection.length;n++)se.selection[n]==this&&(o=!0);o||(se.selection.push(this),s.se=se.selection.length,this.initialStates={position:e(this).css("position"),top:e(this).css("top")}),this.ev||(this.ev=[]),this.ev.push(s),this.ev.sort(sortByOrder)}),window.raf.off("scroll",c).on("scroll",c),window.raf.off("afterdocumentresize",v).on("afterdocumentresize",v),this)}}),e(document).ready(function(){v()})}(jQuery);